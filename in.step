# 2d flow around a flat plate with a protrusion

seed	    	    12345
dimension   	    2
global        gridcut 0.0 comm/sort yes

boundary	    so o p


create_box  	    0 6.0 0 1.5 -0.5 0.5
create_grid 	    800 150 1
balance_grid        rcb cell

global		    nrho 7.2658402E+15 fnum 5e8

species		    air.species O2 N2 H O He

#Can either define mixture ppm^3, or define global ppm^3 and mixture fractions.
#Densities at 200km altitude at (0,0) lat & long, at 12:00 on 19/04/1995
mixture air vstream 7810 0 0
mixture air H nrho 3.23032E+11
mixture air He nrho 1.51812E+13
mixture air O nrho 3.47598E+15
mixture air N2 nrho 3.54661E+15
mixture air O2 nrho 2.36361E+14
mixture air temp 819.27014


read_surf	    geometry.step &
trans 2.0 0.0 0 &
scale 1 1 1



#Check energy accommodation factor (v this number). normally between 0.5 and 0.9
surf_collide	    1 diffuse 300.0 0.9
surf_modify         all collide 1
bound_modify	    xlo collide 1

collide             vss air air.vss

create_particles air n 0
fix		    in emit/face air xlo

timestep 	    0.0001



dump                2 image all 100 Pictures/image.*.ppm type type pdiam 0.1 &
                    surf proc 0.01 size 5024 5024 axes yes 0.9 0.02
dump_modify	        2 pad 4

#Overall Density Dump
compute          1 grid air nrho
fix   1 ave/grid 1 100 100 c_1[*]
dump  1 grid all 100 /dev/shm/pdens.*.grid id xlo ylo f_1 proc

#Species Density Dump
compute 	     2 grid species nrho 
fix   2 ave/grid 1 100 100 c_2[*]
dump  species grid all 100 /dev/shm/speciesdens.*.grid id xlo ylo f_2[*] proc

#Surface Force dump
compute 	     3 surf all air fx fy &
px py shx shy
fix   3 ave/surf all 1 100 100 c_3[*] ave one
dump  3 surf all 100 /dev/shm/forces.*.surf id f_3[*]
#dump_modify      3 buffer yes

#Boundary dump
compute       5 boundary air n &
press shx shy
fix   5 ave/time 1 100 100 c_5[*] mode vector file /dev/shm/Boundary.surf

stats		    50
stats_style	    step cpu np nattempt ncoll nscoll nscheck

run 		    100


















































